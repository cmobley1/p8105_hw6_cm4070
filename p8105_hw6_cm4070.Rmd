---
title: "p8105_hw6_cm4070"
author: "Claire Mobley"
date: "12/1/2021"
output: github_document 
---

```{r}
library(tidyverse)
set.seed(1)
library(rvest)
library(modelr)
library(mgcv)
library(patchwork)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

## Problem 1

## Load and Clean the `Birthweight` Dataset

This code will change the babysex numeric variable into a factor with 2 levels, "male" and "female", the frace numeric variable into factor variable with levels,  "white", "black", "asian", "puerto rican", "other", "unknown", and the m race variable into factor variable with levels "white", "black", "asian", "puerto rican", "other", and for missing values.

```{r}
birthweight_data = read_csv("./birthweight.csv") %>% 
 mutate(babysex = factor(babysex, levels = c("1", "2"), labels = c("male", "female")),
        frace = factor(frace, levels = c("1", "2", "3", "4", "8", "9"), labels = c("white", "black", "asian", "puerto rican", "other", "unknown")), 
        malform = factor(malform, levels = c("0", "1"), labels = c("absent", "present")),
        mrace = factor(mrace, levels = c("1", "2", "3", "4", "8"), labels = c("white", "black", "asian", "puerto rican", "other"))) 

sum(is.na(birthweight_data))
```

## Propose a regression model 

The code below will propose a model for birthweight. Based on scientific literature regarding predictors of child birthweight, I propose the following variables are contributors to overall birthweight and important to be included in the model.

```{r}
fit = lm(bwt ~ babysex + delwt + gaweeks + mheight + momage + smoken, data = birthweight_data)

broom::tidy(fit)
broom::glance(fit)
```

## Diagnostics

This code will provide a plot of model residuals against fitted values.

```{r}
birthweight_data %>% 
  modelr::add_residuals(fit) %>% 
  modelr::add_predictions(fit) %>% 
  ggplot(aes(x = pred, y = resid)) +
  geom_point()
```

