p8105\_hw6\_cm4070
================
Claire Mobley
12/1/2021

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──

    ## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
    ## ✓ tibble  3.1.4     ✓ dplyr   1.0.7
    ## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
    ## ✓ readr   2.0.1     ✓ forcats 0.5.1

    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
set.seed(1)
library(rvest)
```

    ## 
    ## Attaching package: 'rvest'

    ## The following object is masked from 'package:readr':
    ## 
    ##     guess_encoding

``` r
library(modelr)
library(mgcv)
```

    ## Loading required package: nlme

    ## 
    ## Attaching package: 'nlme'

    ## The following object is masked from 'package:dplyr':
    ## 
    ##     collapse

    ## This is mgcv 1.8-38. For overview type 'help("mgcv-package")'.

``` r
library(patchwork)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

## Problem 1

## Load and Clean the `Birthweight` Dataset

This code will change the babysex numeric variable into a factor with 2
levels, “male” and “female”, the frace numeric variable into factor
variable with levels, “white”, “black”, “asian”, “puerto rican”,
“other”, “unknown”, and the m race variable into factor variable with
levels “white”, “black”, “asian”, “puerto rican”, “other”, and look for
any missing values.

``` r
birthweight_data = read_csv("./birthweight.csv") %>% 
 mutate(babysex = factor(babysex, levels = c("1", "2"), labels = c("male", "female")),
        frace = factor(frace, levels = c("1", "2", "3", "4", "8", "9"), labels = c("white", "black", "asian", "puerto rican", "other", "unknown")), 
        malform = factor(malform, levels = c("0", "1"), labels = c("absent", "present")),
        mrace = factor(mrace, levels = c("1", "2", "3", "4", "8"), labels = c("white", "black", "asian", "puerto rican", "other"))) 
```

    ## Rows: 4342 Columns: 20

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (20): babysex, bhead, blength, bwt, delwt, fincome, frace, gaweeks, malf...

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
sum(is.na(birthweight_data))
```

    ## [1] 0

## Propose a regression model

The code below will propose a model for birthweight. Based on scientific
literature regarding predictors of child birthweight, I propose the
following variables are contributors to overall birthweight and
important to be included in the model.

``` r
fit = lm(bwt ~ babysex + delwt + gaweeks + mheight + momage + smoken, data = birthweight_data)

broom::tidy(fit)
```

    ## # A tibble: 7 × 5
    ##   term          estimate std.error statistic   p.value
    ##   <chr>            <dbl>     <dbl>     <dbl>     <dbl>
    ## 1 (Intercept)   -1146.     180.        -6.37 2.13e- 10
    ## 2 babysexfemale   -94.3     13.4       -7.02 2.58e- 12
    ## 3 delwt             4.72     0.333     14.2  1.36e- 44
    ## 4 gaweeks          61.5      2.15      28.6  1.28e-164
    ## 5 mheight          16.2      2.78       5.82 6.24e-  9
    ## 6 momage            9.69     1.75       5.52 3.55e-  8
    ## 7 smoken           -7.78     0.909     -8.55 1.61e- 17

``` r
broom::glance(fit)
```

    ## # A tibble: 1 × 12
    ##   r.squared adj.r.squared sigma statistic   p.value    df  logLik    AIC    BIC
    ##       <dbl>         <dbl> <dbl>     <dbl>     <dbl> <dbl>   <dbl>  <dbl>  <dbl>
    ## 1     0.258         0.257  442.      251. 3.71e-276     6 -32601. 65219. 65270.
    ## # … with 3 more variables: deviance <dbl>, df.residual <int>, nobs <int>

## Diagnostics

This code will provide a plot of model residuals against fitted values.

``` r
birthweight_data %>% 
  modelr::add_residuals(fit) %>% 
  modelr::add_predictions(fit) %>% 
  ggplot(aes(x = pred, y = resid)) +
  geom_point()
```

<img src="p8105_hw6_cm4070_files/figure-gfm/unnamed-chunk-4-1.png" width="90%" />

# Compare to other models

This model uses length at birth and gestational age as predictors:

``` r
fit1 = lm(bwt ~ blength + gaweeks, data = birthweight_data)

broom::tidy(fit1)
```

    ## # A tibble: 3 × 5
    ##   term        estimate std.error statistic  p.value
    ##   <chr>          <dbl>     <dbl>     <dbl>    <dbl>
    ## 1 (Intercept)  -4348.      98.0      -44.4 0       
    ## 2 blength        129.       1.99      64.6 0       
    ## 3 gaweeks         27.0      1.72      15.7 2.36e-54

This model uses head circumference, length, sex, and all interactions
between these as predictors

``` r
fit2 = lm(bwt ~ bhead * blength * babysex, data = birthweight_data)

broom::tidy(fit2)
```

    ## # A tibble: 8 × 5
    ##   term                         estimate std.error statistic      p.value
    ##   <chr>                           <dbl>     <dbl>     <dbl>        <dbl>
    ## 1 (Intercept)                 -7177.     1265.       -5.67  0.0000000149
    ## 2 bhead                         182.       38.1       4.78  0.00000184  
    ## 3 blength                       102.       26.2       3.90  0.0000992   
    ## 4 babysexfemale                6375.     1678.        3.80  0.000147    
    ## 5 bhead:blength                  -0.554     0.780    -0.710 0.478       
    ## 6 bhead:babysexfemale          -198.       51.1      -3.88  0.000105    
    ## 7 blength:babysexfemale        -124.       35.1      -3.52  0.000429    
    ## 8 bhead:blength:babysexfemale     3.88      1.06      3.67  0.000245
